<!DOCTYPE html>
<html>
<head>
  <title>CRUD de Vendas - Taylor Swift</title>
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <h1>CRUD de Vendas - Taylor Swift</h1>

  <div>
    <h2>Lista de Álbuns</h2>
    <ul id="album-list"></ul>
  </div>

  <div>
    <h2>Adicionar Novo Álbum</h2>
    <form id="add-album-form">
      <label for="album-title">Título:</label>
      <input type="text" id="album-title" required><br>
      <label for="album-price">Preço:</label>
      <input type="number" id="album-price" required><br>
      <button type="submit">Adicionar</button>
    </form>
  </div>

  <div>
    <h2>Atualizar Álbum</h2>
    <form id="update-album-form">
      <label for="update-album-id">ID:</label>
      <input type="text" id="update-album-id" required><br>
      <label for="update-album-title">Título:</label>
      <input type="text" id="update-album-title" required><br>
      <label for="update-album-price">Preço:</label>
      <input type="number" id="update-album-price" required><br>
      <button type="submit">Atualizar</button>
    </form>
  </div>

  <div>
    <h2>Excluir Álbum</h2>
    <form id="delete-album-form">
      <label for="delete-album-id">ID:</label>
      <input type="text" id="delete-album-id" required><br>
      <button type="submit">Excluir</button>
    </form>
  </div>

  <script src="script.js"></script>
  <script>
    // Evento de carregamento da página
    document.addEventListener("DOMContentLoaded", function() {
      // Função para buscar a lista de álbuns
      function fetchAlbums() {
        fetch("https://649a1d4a79fbe9bcf8404b5a.mockapi.io/users/20201214010018/products")
          .then(response => response.json())
          .then(albums => {
            const albumList = document.getElementById("album-list");
            albumList.innerHTML = "";

            albums.forEach(album => {
              const li = document.createElement("li");
              li.innerHTML = `${album.title} - $${album.price}`;
              albumList.appendChild(li);
            });
          })
          .catch(error => console.log(error));
      }

      // Evento de envio do formulário para adicionar um álbum
      const addAlbumForm = document.getElementById("add-album-form");
      addAlbumForm.addEventListener("submit", function(event) {
        event.preventDefault();
        const albumTitle = document.getElementById("album-title").value;
        const albumPrice = document.getElementById("album-price").value;

        fetch("https://649a1d4a79fbe9bcf8404b5a.mockapi.io/users/20201214010018/products", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ title: albumTitle, price: albumPrice })
        })
          .then(response => response.json())
          .then(() => {
            fetchAlbums();
            addAlbumForm.reset();
          })
          .catch(error => console.log(error));
      });

      // Evento de envio do formulário para atualizar um álbum
      const updateAlbumForm = document.getElementById("update-album-form");
      updateAlbumForm.addEventListener("submit", function(event) {
        event.preventDefault();
        const albumId = document.getElementById("update-album-id").value;
        const albumTitle = document.getElementById("update-album-title").value;
        const albumPrice = document.getElementById("update-album-price").value;

        fetch(`https://649a1d4a79fbe9bcf8404b5a.mockapi.io/users/20201214010018/products/${albumId}`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ title: albumTitle, price: albumPrice })
        })
          .then(response => response.json())
          .then(() => {
            fetchAlbums();
            updateAlbumForm.reset();
          })
          .catch(error => console.log(error));
      });

      // Evento de envio do formulário para excluir um álbum
      const deleteAlbumForm = document.getElementById("delete-album-form");
      deleteAlbumForm.addEventListener("submit", function(event) {
        event.preventDefault();
        const albumId = document.getElementById("delete-album-id").value;

        if (confirm("Tem certeza de que deseja excluir este álbum?")) {
          fetch(`https://649a1d4a79fbe9bcf8404b5a.mockapi.io/users/20201214010018/products/${albumId}`, {
            method: "DELETE"
          })
            .then(() => {
              fetchAlbums();
              deleteAlbumForm.reset();
            })
            .catch(error => console.log(error));
        }
      });

      // Buscar a lista de álbuns ao carregar a página
      fetchAlbums();
    });
  </script>
</body>
</html>
